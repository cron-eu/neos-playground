version: '3.7'

# Example docker-compose using the images we build here

services:
    web:
        image: croneu/phpapp-web:apache-2.4
        ports:
            - "4000:80"
            - "4443:443"
        volumes:
            - ./app:/app
        env_file:
            - '.env.docker'
            - '.env'
        networks:
            default:
                aliases:
                    - example-app.vm

    php:
        image: croneu/phpapp-fpm:php-8.1
        env_file:
            - '.env.docker'
            - '.env'
        volumes:
            - ./app:/app
            - ./scripts:/scripts
            - data:/app/Data
            - packages:/app/Packages

    mysql:
        image: croneu/phpapp-db:mariadb-10.7
#        ports:
#            - 13306:3306
        volumes:
            - mysql:/var/lib/mysql
        environment:
            MARIADB_ROOT_PASSWORD: ${DB_PASS}
            MARIADB_DATABASE: ${DB_NAME}
            MARIADB_USER: ${DB_USER}
            MARIADB_PASSWORD: ${DB_PASS}

volumes:
    data:
    packages:
    mysql:
